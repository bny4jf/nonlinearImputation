import numpy


a1 = numpy.array([[ 1.02725622,  0.5176001,  -2.05864265,  1.23721569, -0.72106905,  0.31020889,
   1.03182115],
 [ 1.07123975,  0.54008013, -2.14637137,  1.29162637, -0.75003755,  0.32440195,
   1.07719832],
 [ 1.1921295,   0.57989283, -2.33978741,  1.39230093, -0.82495065,  0.35665218,
   1.15228406],
 [ 1.4996324 ,  0.89112044, -3.08191948,  1.97792953, -1.03554466,  0.39465755,
   1.64884431]])
b1 = numpy.array([[ 0.12954025 , 0.10149575 , 0.17274183,  0.12996276 , 0.09063694,  0.07967804,
   0.12708357],
 [ 0.21711901,  0.18086076,  0.30319765,  0.23741623,  0.14984034,  0.13398944,
   0.2221814 ],
 [ 2.97397908,  0.87117646,  4.53042755,  2.25323743,  1.68964042,  0.78757515,
   1.65738204],
 [ 7.01029255 , 3.51006939, 12.13844962,  7.76745485,  4.69750453,  1.91450644,
   6.03361828]]
)

a2 = numpy.array([[ 1.01470954 , 0.50724365, -2.0306106  , 1.21785328, -0.71151732,  0.30471889,
   1.01636156],
 [ 1.03106299,  0.51723994, -2.06647681,  1.24041647, -0.72394697,  0.30909333,
   1.03496492],
 [ 1.04045138,  0.52138167, -2.08772044,  1.25236737, -0.73119327,  0.3131551,
   1.04509837],
 [ 1.0138901 ,  0.61210066, -2.17333147,  1.3788245 , -0.72449483 , 0.28192102,
   1.16517125]])

b2= numpy.array([[0.08961579, 0.07054348, 0.11596102, 0.08703768, 0.06134015, 0.05491414,
  0.0856286 ],
 [0.13878747, 0.1185509,  0.18735632, 0.15032367, 0.09772463, 0.08766628,
  0.14509982],
 [0.14242275, 0.07867273, 0.15073804, 0.10206377, 0.07777906, 0.06720136,
  0.09733127],
 [0.14175696, 0.08854494, 0.16819501, 0.11907604, 0.08365428, 0.07090414,
  0.10943478]])

a3 = numpy.array([[ 1.00581683,  0.50204505, -2.01101345,  1.20655051, -0.70449117,  0.30238619,
   1.00621672],
 [ 1.0131092 ,  0.50663293, -2.02959267,  1.21728989, -0.71112976,  0.30383917,
   1.01722718],
 [ 1.01730848,  0.50879099, -2.03796274,  1.222628 ,  -0.71391768,  0.3060213,
   1.02041763],
 [ 1.00034329,  0.5753309,  -2.10107245,  1.31627904, -0.70864686,  0.28371132,
   1.1078926 ]]
)

b3 = numpy.array([[0.06151435, 0.04881332, 0.08100703, 0.06169968, 0.04331079, 0.03766353,
  0.06134309],
 [0.09619565, 0.08319213, 0.12715765, 0.10371681, 0.06733829, 0.05943197,
  0.09891667],
 [0.09718725, 0.05382577, 0.09993611, 0.068655,   0.05333421, 0.04481709,
  0.06706657],
 [0.09628772, 0.06013854, 0.10843431, 0.07732557, 0.05616947, 0.04730025,
  0.07356644]])

true = [1,0.5,-2, 1.2, -0.7, 0.3]

def evaluatorMSE(a, b, true):
    MSE_vector = (a - true)**2 + b**2
    MSE_average = numpy.mean(MSE_vector, axis=1)
    MSE_averageNormalized = MSE_average / MSE_average[0]
    MSE_normalized = MSE_vector / MSE_vector[0]
    print('Average MSE: \n', MSE_average)
    print('\nNormalized Average MSE: \n', MSE_averageNormalized)
    print('\nNormalized MSE: \n', MSE_normalized)

evaluatorMSE(a1,b1,true)
evaluatorMSE(a2,b2,true)
evaluatorMSE(a3,b3,true)

###################
# CLEANING TABLES #
###################

def tableCleaner(fname, true):
    """Enter the .npy filename, define 'true' before running containing the true
    values in order AS A LIST!!!!
    """
    with open(fname, 'rb') as f:
        res1 = numpy.load(f)
    #    res2 = numpy.load(f)
    print("The true values are", true)
    print("Number of repetitions before cleaning: ", len(res1))
    resnew = numpy.stack([arr for arr in res1 if numpy.max(numpy.abs(arr))<100])
    a = numpy.mean(resnew, axis=0)
    b= numpy.std(resnew, axis=0)
    true = numpy.stack([true] * resnew.shape[1])
    print("Number of repetitions after cleaning:", len(resnew))
    print('\n\nMeans:\n', a)
    print('Standard deviations:\n', b)
    print('\n\nMSE report\n')
    evaluatorMSE(a, b, true)

for n in [1000, 2000, 4000]:
    print('n=', n)
#    tableCleaner('LinearNW5'+str(n), true)
    print('\n\n\n')
